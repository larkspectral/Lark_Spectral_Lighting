# Calculate quantities of the CIE S 026 toolbox 

# Lark Spectral Lighting (v0.0.1, v0.0.2 and v1.0) is a collaboration of University of Washington and ZGF Architects LLP
# Authors Dr. Mehlika Inanici, Marty Brennan & Ed Clark
# Lark v2.0 is a collaboration of EPFL, Oregon State University, and Eindhoven University of Technology
# Authors Dr. Clotilde Pierson & Myrta Gkaintatzi-Masouti
# Copyright 2015-2022 Mehlika Inanici, Ph.D. (University of Washington) and ZGF Architects LLP
# Copyright 2022 Clotilde Pierson, Ph.D. (EPFL, Oregon State University) and Myrta Gkaintatzi-Masouti, M.Sc. (Eindhoven University of Technology)
# Licensed under The Modified 3-Clause BSD License (the "License");
# You may obtain a copy of the License at
# https://opensource.org/licenses/BSD-3-Clause

"""
Use this component to calculate the quantities of the CIE S 026 toolbox
-
Provided by Lark 2.0.0

    Args:
        channel_output: The 9 or 3 channel values from the Radiance calculation
        alpha: Action spectrum of interest. 1: S-cone-opic, 2: M-cone-opic, 3: L-cone-opic, 4: rhodopic, 5: melanopic
    Returns:
        Irradiance: Spectral irradiance every 1nm (W/m2/nm)
        alpha_opic_irrad: alpha-opic irradiance (W/m2)
        alpha_opic_ELR: alpha-opic efficacy of luminous radiation (mW/lm)
        alpha_opic_EDI: alpha-opic equivalent (D65) illuminance (lx)
"""

__author__ = "mgkaintatzi-masouti"
__version__ = "2021.09.15"

ghenv.Component.Name = "Lark CIE Toolbox Alpha-opic Quantities"
ghenv.Component.NickName = 'CIE Toolbox'
ghenv.Component.Message = '2.0.0'
ghenv.Component.Category = "Lark"
ghenv.Component.SubCategory = "Utilities"

from Grasshopper.Kernel import GH_RuntimeMessageLevel as RML



#check all inputs
error_list = []
inputs = [channel_output, alpha]
inputs_name = ["channel_output", "alpha"]

for idx, val in enumerate (inputs):
    if val == None or val == []:
        error_list.append(inputs_name[idx])

if len(error_list) != 0:
    check = "error"
else:
    check = 1

if check == "error":
    print "Warning! Connect the following inputs:" 
    print error_list



#calculate the alpha-opic values
if check != "error":
    
    #define the action spectra
    S = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00614265, 0.0074428, 0.00901661, 0.010917, 0.0132053, 0.0159515, 0.0192347, 0.0231436, 0.027775, 0.0332339, 0.0396308, 0.0470801, 0.0557012, 0.0656137, 0.0769323, 0.0897612, 0.104188, 0.120273, 0.138044, 0.157485, 0.17853, 0.201077, 0.225091, 0.250566, 0.277507, 0.305941, 0.335858, 0.366981, 0.398876, 0.430998, 0.462692, 0.493357, 0.523006, 0.551939, 0.580599, 0.60957, 0.639359, 0.669651, 0.699829, 0.729177, 0.756885, 0.782292, 0.805666, 0.827599, 0.84878, 0.869984, 0.891761, 0.913444, 0.933977, 0.952218, 0.96696, 0.97734, 0.984028, 0.988144, 0.990851, 0.993336, 0.996373, 0.999038, 0.999978, 0.997844, 0.991329, 0.979657, 0.963905, 0.945573, 0.926078, 0.906735, 0.888509, 0.871353, 0.854998, 0.839198, 0.823726, 0.808307, 0.792431, 0.775569, 0.757244, 0.737043, 0.71473, 0.690558, 0.66489, 0.638078, 0.610456, 0.582346, 0.554065, 0.525903, 0.498108, 0.470894, 0.44445, 0.418992, 0.394699, 0.371707, 0.350108, 0.329904, 0.310864, 0.292741, 0.275338, 0.258497, 0.242158, 0.226504, 0.211726, 0.19796, 0.185297, 0.173751, 0.163149, 0.153311, 0.144086, 0.135351, 0.127011, 0.119017, 0.111333, 0.103934, 0.096799, 0.0899169, 0.0832878, 0.0769157, 0.0708052, 0.0649614, 0.0594049, 0.0542076, 0.0494281, 0.0450993, 0.0412337, 0.0378142, 0.0347627, 0.0320029, 0.0294746, 0.02713, 0.0249376, 0.0228931, 0.0209956, 0.0192427, 0.0176298, 0.0161501, 0.0147911, 0.0135407, 0.0123884, 0.0113252, 0.0103437, 0.00944092, 0.00861365, 0.00785831, 0.00717089, 0.00654648, 0.00597777, 0.00545794, 0.00498125, 0.00454287, 0.00413908, 0.00376794, 0.00342783, 0.00311696, 0.00283352, 0.00257556, 0.00234084, 0.00212722, 0.00193276, 0.00175573, 0.00159455, 0.00144783, 0.0013143, 0.00119281, 0.0010823, 0.000981819, 0.000890533, 0.000807687, 0.000732568, 0.000664512, 0.000602887, 0.000547062, 0.000496461, 0.000450571, 0.000408931, 0.000371136, 0.000336838, 0.000305723, 0.000277504, 0.000251918, 0.000228725, 0.000207699, 0.000188638, 0.000171357, 0.000155688, 0.00014148, 0.000128596, 0.000116912, 0.000106316, 9.67E-05, 8.80E-05, 8.01E-05, 7.29E-05, 6.64E-05, 6.05E-05, 0.000055102, 5.02E-05, 4.58E-05, 4.18E-05, 3.81E-05, 3.48E-05, 3.18E-05, 2.90E-05, 2.65E-05, 2.43E-05, 2.22E-05, 2.03E-05, 1.86E-05, 1.70E-05, 1.56E-05, 1.43E-05, 1.31E-05, 1.20E-05, 1.10E-05, 1.01E-05, 9.31E-06, 8.56E-06, 7.87E-06, 7.24E-06, 6.67E-06, 6.14E-06, 5.66E-06, 5.22E-06, 4.81E-06, 4.44E-06, 4.10E-06, 3.79E-06, 3.50E-06, 3.24E-06, 2.99E-06, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    M = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000358227, 0.00043866, 0.00053623, 0.000654061, 0.000795649, 0.000964828, 0.00116572, 0.00140263, 0.00167992, 0.0020018, 0.00237208, 0.00279433, 0.00327374, 0.0038166, 0.00443021, 0.00512316, 0.00590458, 0.00678005, 0.0077526, 0.00882286, 0.00998841, 0.0112452, 0.0125949, 0.0140425, 0.0155944, 0.0172596, 0.0190467, 0.0209545, 0.0229763, 0.0251017, 0.0273163, 0.0296062, 0.0319746, 0.034433, 0.0369983, 0.0396928, 0.0425402, 0.0455474, 0.0487161, 0.0520467, 0.0555384, 0.0591876, 0.0629819, 0.0669031, 0.0709285, 0.0750299, 0.0791769, 0.0833463, 0.087516, 0.0916625, 0.0957612, 0.0997977, 0.103804, 0.107834, 0.111948, 0.11622, 0.120706, 0.125363, 0.130111, 0.134856, 0.139493, 0.143943, 0.148281, 0.152637, 0.157157, 0.162006, 0.167331, 0.173144, 0.179417, 0.186117, 0.193202, 0.200621, 0.208315, 0.216212, 0.224231, 0.232275, 0.240257, 0.24816, 0.255987, 0.263744, 0.271441, 0.279097, 0.286755, 0.294476, 0.302323, 0.310372, 0.318692, 0.327307, 0.336232, 0.34548, 0.355066, 0.364985, 0.375142, 0.38541, 0.395646, 0.405688, 0.415435, 0.425064, 0.434851, 0.445097, 0.456137, 0.468236, 0.481255, 0.494927, 0.508947, 0.52297, 0.536701, 0.550195, 0.563616, 0.57715, 0.591003, 0.60535, 0.62016, 0.635343, 0.650796, 0.666404, 0.682055, 0.697672, 0.713186, 0.728526, 0.743612, 0.758396, 0.772966, 0.787457, 0.802017, 0.816808, 0.831919, 0.847096, 0.861972, 0.876152, 0.889214, 0.900812, 0.911006, 0.919968, 0.92789, 0.934977, 0.941414, 0.947279, 0.952622, 0.957498, 0.961962, 0.96608, 0.969966, 0.973743, 0.977539, 0.981481, 0.985629, 0.989754, 0.993551, 0.996714, 0.998931, 0.999942, 0.999692, 0.998178, 0.995405, 0.991383, 0.986199, 0.980229, 0.973906, 0.967653, 0.961876, 0.95682, 0.952151, 0.947398, 0.942105, 0.935829, 0.928274, 0.919667, 0.910356, 0.900677, 0.890949, 0.881386, 0.871834, 0.862059, 0.85184, 0.840969, 0.829303, 0.816911, 0.80391, 0.790413, 0.776526, 0.762311, 0.747669, 0.732476, 0.716622, 0.700013, 0.682647, 0.664817, 0.646858, 0.629072, 0.611728, 0.594998, 0.578783, 0.562935, 0.547321, 0.531825, 0.516354, 0.50087, 0.48535, 0.469777, 0.454142, 0.438454, 0.422778, 0.407188, 0.391752, 0.376527, 0.361559, 0.346856, 0.332422, 0.318261, 0.304378, 0.290784, 0.277506, 0.264575, 0.252012, 0.239837, 0.228065, 0.216703, 0.205754, 0.195221, 0.185104, 0.175398, 0.166091, 0.157169, 0.14862, 0.140431, 0.132591, 0.125092, 0.117928, 0.111091, 0.104573, 0.0983663, 0.0924685, 0.0868759, 0.0815834, 0.0765841, 0.0718683, 0.0674186, 0.0632176, 0.0592492, 0.055499, 0.051955, 0.0486103, 0.0454591, 0.0424945, 0.0397097, 0.0370952, 0.0346347, 0.0323125, 0.0301151, 0.0280314, 0.0260564, 0.0242011, 0.022476, 0.020887, 0.0194366, 0.01812, 0.0169149, 0.0157991, 0.0147543, 0.013766, 0.0128246, 0.0119304, 0.011085, 0.0102892, 0.00954315, 0.00884609, 0.008196, 0.00759059, 0.00702754, 0.00650455, 0.00601952, 0.00557093, 0.00515728, 0.00477687, 0.00442794, 0.00410832, 0.0038147, 0.00354392, 0.00329329, 0.0030605, 0.00284369, 0.00264175, 0.00245374, 0.00227875, 0.00211596, 0.00196456, 0.00182378, 0.00169287, 0.00157115, 0.00145798, 0.00135274, 0.00125476, 0.0011634, 0.00107812, 0.000998424, 0.000923962, 0.000854713, 0.000790652, 0.000731684, 0.000677653, 0.000628297, 0.000583108, 0.000541584, 0.000503294, 0.00046787, 0.000435007, 0.00040449, 0.000376138, 0.000349784, 0.000325278, 0.000302477, 0.000281237, 0.000261427, 0.00024293, 0.000225641, 0.000209478, 0.0001944, 0.00018037, 0.000167347, 0.000155286, 0.000144135, 0.00013383, 0.000124309, 0.000115513, 0.000107388, 0.00009988, 0.000092932, 8.65E-05, 0.000080509, 7.49E-05, 6.98E-05, 0.000064947, 6.05E-05, 5.63E-05, 5.25E-05, 4.89E-05, 4.56E-05, 0.000042549, 3.97E-05, 3.70E-05, 3.46E-05, 3.23E-05, 3.01E-05, 2.81E-05, 2.62E-05, 2.45E-05, 2.28E-05, 2.13E-05, 1.99E-05, 1.86E-05, 1.74E-05, 1.63E-05, 1.53E-05, 1.43E-05, 1.34E-05, 1.25E-05, 1.17E-05, 1.10E-05, 0.00001029, 9.63E-06, 9.02E-06, 8.45E-06, 7.92E-06, 0.000007427, 6.97E-06, 6.53E-06, 6.13E-06, 5.75E-06, 5.40E-06, 5.07E-06, 4.75E-06, 4.46E-06, 4.18E-06, 3.93E-06, 3.69E-06, 3.46E-06, 3.25E-06, 3.05E-06, 2.87E-06, 2.70E-06, 2.53E-06, 2.38E-06, 2.23E-06, 2.09E-06, 1.97E-06, 1.85E-06, 1.74E-06, 1.64E-06, 1.55E-06, 1.46E-06]
    L = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000407619, 0.000497068, 0.000604713, 0.00073364, 0.000887247, 0.00106921, 0.0012834, 0.00153382, 0.00182443, 0.00215896, 0.00254073, 0.00297282, 0.00345993, 0.00400793, 0.0046237, 0.00531546, 0.00609138, 0.00695291, 0.00789634, 0.008913, 0.00998835, 0.0111054, 0.0122607, 0.0134578, 0.0147044, 0.016013, 0.0173958, 0.0188452, 0.020344, 0.02187, 0.0233957, 0.0248961, 0.0263761, 0.0278541, 0.0293551, 0.0309104, 0.0325498, 0.0342714, 0.036062, 0.0379052, 0.039781, 0.0416705, 0.0435728, 0.0454932, 0.0474385, 0.0494172, 0.0514343, 0.0534735, 0.0555102, 0.0575166, 0.0594619, 0.061324, 0.0631288, 0.0649189, 0.0667425, 0.0686538, 0.0706963, 0.0728508, 0.0750778, 0.0773325, 0.0795647, 0.0817368, 0.0838826, 0.0860598, 0.0883322, 0.0907704, 0.0934397, 0.0963577, 0.0995304, 0.102964, 0.106663, 0.110629, 0.114828, 0.119217, 0.12374, 0.128336, 0.132947, 0.13757, 0.142218, 0.146905, 0.151651, 0.156475, 0.161404, 0.166464, 0.17169, 0.177116, 0.182777, 0.188685, 0.194845, 0.201261, 0.20794, 0.214875, 0.222022, 0.229316, 0.236684, 0.244046, 0.251347, 0.258695, 0.266252, 0.274202, 0.282752, 0.292071, 0.302094, 0.312673, 0.323637, 0.334786, 0.345943, 0.357126, 0.368416, 0.379907, 0.391705, 0.403905, 0.4165, 0.429453, 0.44272, 0.456252, 0.469997, 0.483926, 0.498012, 0.512227, 0.526538, 0.540923, 0.555406, 0.570025, 0.584828, 0.599867, 0.615162, 0.630569, 0.645883, 0.66088, 0.675313, 0.688975, 0.701886, 0.71414, 0.725841, 0.737108, 0.748046, 0.758684, 0.769032, 0.779099, 0.7889, 0.798472, 0.807945, 0.817478, 0.827239, 0.837403, 0.848078, 0.859064, 0.870068, 0.880779, 0.890871, 0.900057, 0.908253, 0.915433, 0.921575, 0.92666, 0.930744, 0.93416, 0.937318, 0.940634, 0.944527, 0.949291, 0.95468, 0.960309, 0.965785, 0.970703, 0.974756, 0.978055, 0.980819, 0.983271, 0.985636, 0.988085, 0.99056, 0.992945, 0.995124, 0.996979, 0.998411, 0.999391, 0.999912, 0.999965, 0.999543, 0.998615, 0.997051, 0.994701, 0.991416, 0.987057, 0.981599, 0.975451, 0.96912, 0.963093, 0.957841, 0.953664, 0.950236, 0.947086, 0.943752, 0.939781, 0.934826, 0.928917, 0.922177, 0.914729, 0.906693, 0.89817, 0.889188, 0.879759, 0.869894, 0.859605, 0.848912, 0.837865, 0.826522, 0.81494, 0.803173, 0.791253, 0.779118, 0.766691, 0.7539, 0.74068, 0.726995, 0.712905, 0.698491, 0.683829, 0.668991, 0.654037, 0.638979, 0.623825, 0.608579, 0.593248, 0.577857, 0.562493, 0.547248, 0.532209, 0.517449, 0.502993, 0.488692, 0.474376, 0.459896, 0.445125, 0.430007, 0.414687, 0.39934, 0.384122, 0.369168, 0.35458, 0.340389, 0.326609, 0.313249, 0.300316, 0.287817, 0.275762, 0.264158, 0.253009, 0.242316, 0.232061, 0.222158, 0.212516, 0.20306, 0.19373, 0.184495, 0.175402, 0.166509, 0.157865, 0.149509, 0.14147, 0.13376, 0.126383, 0.119343, 0.112638, 0.106264, 0.100208, 0.0944558, 0.0889934, 0.0838077, 0.0788866, 0.0742192, 0.0697953, 0.065605, 0.0616384, 0.0578857, 0.0543366, 0.0509811, 0.0478096, 0.0448132, 0.0419831, 0.0393111, 0.0367892, 0.0344098, 0.032166, 0.0300509, 0.0280594, 0.0261861, 0.024426, 0.0227738, 0.0212238, 0.0197679, 0.0183986, 0.0171092, 0.0158939, 0.0147492, 0.0136773, 0.0126804, 0.011759, 0.0109123, 0.0101373, 0.00942568, 0.00876917, 0.00816076, 0.00759453, 0.00706588, 0.00657252, 0.00611262, 0.0056844, 0.00528607, 0.00491573, 0.00457086, 0.00424908, 0.00394832, 0.00366675, 0.00340297, 0.00315632, 0.00292624, 0.00271213, 0.00251327, 0.00232895, 0.00215836, 0.00200071, 0.00185521, 0.00172108, 0.0015975, 0.00148342, 0.00137787, 0.00127998, 0.001189, 0.00110433, 0.00102563, 0.000952602, 0.000884959, 0.000822396, 0.000764585, 0.00071111, 0.00066157, 0.000615612, 0.000572917, 0.000533206, 0.000496234, 0.000461782, 0.000429654, 0.00039967, 0.00037169, 0.00034565, 0.000321494, 0.000299155, 0.000278553, 0.000259583, 0.000242061, 0.000225809, 0.000210674, 0.000196528, 0.000183271, 0.000170868, 0.00015929, 0.000148506, 0.000138482, 0.000129179, 0.000120542, 0.000112519, 0.000105061, 9.81E-05, 9.17E-05, 8.56E-05, 8.00E-05, 7.48E-05, 6.99E-05, 6.53E-05, 6.10E-05, 5.70E-05, 5.33E-05, 0.000049843, 4.66E-05, 4.36E-05, 4.09E-05, 3.82E-05, 3.58E-05, 3.35E-05, 3.13E-05, 2.93E-05, 2.74E-05, 2.56E-05, 2.40E-05, 0.000022516, 2.11E-05, 1.98E-05, 1.86E-05]
    rhod = [0.000589, 0.000665, 0.000752, 0.000854, 0.000972, 0.001108, 0.001268, 0.001453, 0.001668, 0.001918, 0.002209, 0.002547, 0.002939, 0.003394, 0.003921, 0.00453, 0.00524, 0.00605, 0.00698, 0.00806, 0.00929, 0.0107, 0.01231, 0.01413, 0.01619, 0.01852, 0.02113, 0.02405, 0.0273, 0.03089, 0.03484, 0.03916, 0.0439, 0.049, 0.0545, 0.0604, 0.0668, 0.0736, 0.0808, 0.0885, 0.0966, 0.1052, 0.1141, 0.1235, 0.1334, 0.1436, 0.1541, 0.1651, 0.1764, 0.1879, 0.1998, 0.2119, 0.2243, 0.2369, 0.2496, 0.2625, 0.2755, 0.2886, 0.3017, 0.3149, 0.3281, 0.3412, 0.3543, 0.3673, 0.3803, 0.3931, 0.406, 0.418, 0.431, 0.443, 0.455, 0.467, 0.479, 0.49, 0.502, 0.513, 0.524, 0.535, 0.546, 0.557, 0.567, 0.578, 0.588, 0.599, 0.61, 0.62, 0.631, 0.642, 0.653, 0.664, 0.676, 0.687, 0.699, 0.71, 0.722, 0.734, 0.745, 0.757, 0.769, 0.781, 0.793, 0.805, 0.817, 0.828, 0.84, 0.851, 0.862, 0.873, 0.884, 0.894, 0.904, 0.914, 0.923, 0.932, 0.941, 0.949, 0.957, 0.964, 0.97, 0.976, 0.982, 0.986, 0.99, 0.994, 0.997, 0.998, 1, 1, 1, 0.998, 0.997, 0.994, 0.99, 0.986, 0.981, 0.975, 0.968, 0.961, 0.953, 0.944, 0.935, 0.925, 0.915, 0.904, 0.892, 0.88, 0.867, 0.854, 0.84, 0.826, 0.811, 0.796, 0.781, 0.765, 0.749, 0.733, 0.717, 0.7, 0.683, 0.667, 0.65, 0.633, 0.616, 0.599, 0.581, 0.564, 0.548, 0.531, 0.514, 0.497, 0.481, 0.465, 0.448, 0.433, 0.417, 0.402, 0.3864, 0.3715, 0.3569, 0.3427, 0.3288, 0.3151, 0.3018, 0.2888, 0.2762, 0.2639, 0.2519, 0.2403, 0.2291, 0.2182, 0.2076, 0.1974, 0.1876, 0.1782, 0.169, 0.1602, 0.1517, 0.1436, 0.1358, 0.1284, 0.1212, 0.1143, 0.1078, 0.1015, 0.0956, 0.0899, 0.0845, 0.0793, 0.0745, 0.0699, 0.0655, 0.0613, 0.0574, 0.0537, 0.0502, 0.0469, 0.0438, 0.0409, 0.03816, 0.03558, 0.03315, 0.03087, 0.02874, 0.02674, 0.02487, 0.02312, 0.02147, 0.01994, 0.01851, 0.01718, 0.01593, 0.01477, 0.01369, 0.01269, 0.01175, 0.01088, 0.01007, 0.00932, 0.00862, 0.00797, 0.00737, 0.00682, 0.0063, 0.00582, 0.00538, 0.00497, 0.00459, 0.00424, 0.003913, 0.003613, 0.003335, 0.003079, 0.002842, 0.002623, 0.002421, 0.002235, 0.002062, 0.001903, 0.001757, 0.001621, 0.001497, 0.001382, 0.001276, 0.001178, 0.001088, 0.001005, 0.000928, 0.000857, 0.000792, 0.000732, 0.000677, 0.000626, 0.000579, 0.000536, 0.000496, 0.000459, 0.000425, 0.0003935, 0.0003645, 0.0003377, 0.0003129, 0.0002901, 0.0002689, 0.0002493, 0.0002313, 0.0002146, 0.0001991, 0.0001848, 0.0001716, 0.0001593, 0.000148, 0.0001375, 0.0001277, 0.0001187, 0.0001104, 0.0001026, 0.0000954, 0.0000888, 0.0000826, 0.0000769, 0.0000715, 0.0000666, 0.000062, 0.0000578, 0.0000538, 0.0000501, 0.0000467, 0.0000436, 0.0000406, 0.00003789, 0.00003533, 0.00003295, 0.00003075, 0.0000287, 0.00002679, 0.00002501, 0.00002336, 0.00002182, 0.00002038, 0.00001905, 0.0000178, 0.00001664, 0.00001556, 0.00001454, 0.0000136, 0.00001273, 0.00001191, 0.00001114, 0.00001043, 0.00000976, 0.00000914, 0.00000856, 0.00000802, 0.00000751, 0.00000704, 0.0000066, 0.00000618, 0.0000058, 0.00000544, 0.0000051, 0.00000478, 0.00000449, 0.00000421, 0.000003951, 0.000003709, 0.000003482, 0.00000327, 0.00000307, 0.000002884, 0.00000271, 0.000002546, 0.000002393, 0.00000225, 0.000002115, 0.000001989, 0.00000187, 0.000001759, 0.000001655, 0.000001557, 0.000001466, 0.000001379, 0.000001299, 0.000001223, 0.000001151, 0.000001084, 0.000001022, 0.000000962, 0.000000907, 0.000000855, 0.000000806, 0.00000076, 0.000000716, 0.000000675, 0.000000637, 0.000000601, 0.000000567, 0.000000535, 0.000000505, 0.000000477, 0.00000045, 0.000000425, 0.000000401, 0.000000379, 0.000000358, 3.38E-07, 3.20E-07, 3.02E-07, 2.86E-07, 2.70E-07, 2.55E-07, 2.41E-07, 2.28E-07, 2.16E-07, 2.04E-07, 1.93E-07, 1.83E-07, 1.73E-07, 1.64E-07, 1.55E-07, 1.47E-07, 0.000000139]
    mel = [0.000918165, 0.00104557, 0.00117858, 0.00132279, 0.00148381, 0.00166724, 0.00188102, 0.00212989, 0.00241457, 0.00273583, 0.00309442, 0.00350706, 0.00399078, 0.00454679, 0.00517625, 0.00588035, 0.00669334, 0.00765102, 0.00875694, 0.0100146, 0.0114277, 0.0130767, 0.0150397, 0.0173166, 0.0199071, 0.0228112, 0.0263194, 0.0305964, 0.0354538, 0.0407028, 0.046155, 0.0517822, 0.0577804, 0.0642972, 0.0714801, 0.0794766, 0.0891807, 0.100756, 0.113256, 0.125732, 0.137237, 0.147446, 0.157014, 0.166463, 0.176316, 0.187096, 0.19921, 0.212408, 0.226225, 0.240199, 0.253865, 0.267021, 0.279976, 0.293034, 0.3065, 0.320679, 0.336016, 0.352361, 0.369128, 0.385732, 0.401587, 0.416472, 0.430797, 0.444921, 0.459203, 0.474002, 0.489517, 0.505522, 0.521741, 0.537898, 0.553715, 0.5691, 0.58424, 0.599281, 0.61437, 0.629654, 0.645193, 0.660892, 0.67666, 0.692409, 0.708049, 0.723594, 0.739105, 0.75456, 0.769938, 0.785216, 0.800683, 0.816354, 0.831798, 0.846587, 0.860291, 0.872925, 0.88487, 0.896242, 0.907158, 0.917734, 0.928345, 0.93895, 0.949035, 0.958091, 0.965605, 0.971976, 0.977833, 0.983006, 0.987325, 0.990621, 0.993343, 0.995887, 0.998008, 0.999461, 1, 0.999561, 0.998365, 0.99659, 0.994416, 0.992022, 0.988792, 0.98422, 0.978657, 0.972451, 0.965952, 0.958844, 0.950716, 0.941778, 0.932236, 0.922299, 0.911832, 0.900602, 0.888663, 0.876073, 0.862888, 0.848801, 0.833678, 0.817832, 0.801579, 0.785233, 0.768718, 0.751807, 0.734593, 0.717169, 0.699628, 0.681888, 0.663881, 0.645724, 0.627533, 0.609422, 0.591339, 0.573207, 0.555105, 0.537112, 0.519309, 0.501645, 0.484067, 0.466643, 0.449442, 0.432533, 0.415862, 0.399372, 0.383136, 0.367224, 0.351707, 0.336537, 0.321647, 0.307085, 0.292899, 0.279135, 0.265737, 0.252648, 0.239917, 0.227592, 0.215722, 0.204238, 0.193075, 0.182288, 0.17193, 0.162056, 0.152601, 0.143487, 0.134748, 0.126416, 0.118526, 0.111007, 0.103793, 0.0969206, 0.0904259, 0.0843457, 0.0786198, 0.073175, 0.0680288, 0.0631984, 0.0587013, 0.0544832, 0.0504889, 0.0467344, 0.0432357, 0.0400089, 0.0370102, 0.0341903, 0.0315562, 0.0291153, 0.0268747, 0.0248014, 0.0228597, 0.0210534, 0.0193864, 0.0178624, 0.0164578, 0.015147, 0.0139314, 0.012812, 0.0117901, 0.0108488, 0.00997112, 0.0091585, 0.00841242, 0.0077343, 0.00711255, 0.00653476, 0.0060011, 0.00551174, 0.00506686, 0.00465869, 0.00427946, 0.00392939, 0.00360872, 0.00331766, 0.00305109, 0.00280374, 0.0025756, 0.00236668, 0.00217698, 0.00200317, 0.0018419, 0.00169317, 0.00155692, 0.00143314, 0.00131972, 0.00121451, 0.00111743, 0.00102839, 0.000947313, 0.000872814, 0.000803576, 0.00073962, 0.00068097, 0.000627648, 0.000578753, 0.000533358, 0.00049144, 0.00045298, 0.000417955, 0.000385789, 0.000355905, 0.000328289, 0.000302926, 0.000279801, 0.000258544, 0.000238785, 0.000220508, 0.000203699, 0.000188341, 0.000174192, 0.00016102, 0.000148821, 0.000137594, 0.000127337, 0.000117891, 0.000109096, 0.000100949, 9.34437E-05, 8.65751E-05, 8.02405E-05, 7.43383E-05, 0.000068865, 6.38172E-05, 5.91914E-05, 5.49203E-05, 5.09374E-05, 4.72404E-05, 4.38269E-05, 4.06945E-05, 0.000037799, 3.50966E-05, 3.25857E-05, 3.02647E-05, 0.000028132, 2.61587E-05, 2.43158E-05, 2.26017E-05, 2.10148E-05, 1.95535E-05, 1.81982E-05, 1.69302E-05, 1.57493E-05, 1.46553E-05, 0.000013648, 1.27143E-05, 1.18407E-05, 1.10269E-05, 1.02723E-05, 9.57637E-06, 8.93033E-06, 8.32543E-06, 7.76135E-06, 7.23773E-06, 6.75425E-06, 6.30499E-06, 5.88407E-06, 5.49115E-06, 5.12592E-06, 4.78804E-06, 4.47347E-06, 4.17829E-06, 3.90243E-06, 3.64583E-06, 3.40841E-06, 3.18739E-06, 2.97998E-06, 2.78604E-06, 2.60548E-06, 2.43819E-06, 2.28225E-06, 2.1358E-06, 1.99874E-06, 1.87101E-06, 1.75252E-06, 1.64197E-06, 1.53806E-06, 1.44073E-06, 1.34993E-06, 1.2656E-06, 1.18683E-06, 1.11273E-06, 1.04326E-06, 9.78385E-07, 9.18078E-07, 8.61705E-07, 8.0864E-07, 7.58853E-07, 7.12313E-07, 6.68991E-07, 6.28444E-07, 5.90239E-07, 5.54363E-07, 5.20798E-07, 4.89531E-07, 4.60251E-07, 4.32648E-07, 4.0671E-07, 3.8242E-07, 3.59766E-07, 3.38528E-07, 3.1849E-07, 2.99644E-07, 2.81981E-07, 2.65493E-07, 2.50026E-07, 2.35424E-07, 2.21681E-07, 2.08789E-07, 1.9674E-07, 1.85426E-07, 1.74736E-07, 1.64666E-07, 1.55212E-07, 1.4637E-07, 1.38062E-07, 1.30208E-07, 1.22805E-07, 1.15848E-07, 1.09332E-07, 1.03202E-07, 9.74005E-08, 9.19274E-08, 8.67807E-08, 8.19587E-08, 7.74202E-08, 7.31243E-08, 6.90693E-08, 6.52534E-08, 6.16749E-08, 5.83044E-08, 5.51124E-08, 5.20972E-08, 4.92575E-08, 4.65916E-08, 4.40782E-08, 4.16962E-08, 3.94444E-08, 3.73218E-08, 3.53272E-08, 3.34451E-08, 3.166E-08, 2.99712E-08, 2.83782E-08, 2.68803E-08, 2.548E-08, 2.4166E-08, 2.29167E-08, 2.17105E-08, 2.05258E-08]
    V = [0.00004, 0.00004, 0.00005, 0.00005, 0.00006, 0.00006, 0.00007, 0.00008, 0.00009, 0.00011, 0.00012, 0.00013, 0.00015, 0.00017, 0.00019, 0.00022, 0.00025, 0.00028, 0.00032, 0.00036, 0.0004, 0.00043, 0.00047, 0.00052, 0.00057, 0.00064, 0.00072, 0.00083, 0.00094, 0.00107, 0.00121, 0.00136, 0.00153, 0.00172, 0.00194, 0.00218, 0.00245, 0.00276, 0.00312, 0.00353, 0.004, 0.00455, 0.00516, 0.00583, 0.00655, 0.0073, 0.00809, 0.00891, 0.00977, 0.01066, 0.0116, 0.01257, 0.01358, 0.01463, 0.01572, 0.01684, 0.01801, 0.01921, 0.02045, 0.02172, 0.023, 0.02429, 0.02561, 0.02696, 0.02835, 0.0298, 0.03131, 0.03288, 0.03452, 0.03623, 0.038, 0.03985, 0.04177, 0.04377, 0.04584, 0.048, 0.05024, 0.05257, 0.05498, 0.05746, 0.06, 0.0626, 0.06528, 0.06804, 0.07091, 0.0739, 0.07702, 0.08027, 0.08367, 0.08723, 0.09098, 0.09492, 0.09905, 0.10337, 0.10788, 0.1126, 0.11753, 0.12267, 0.12799, 0.13345, 0.13902, 0.14468, 0.15047, 0.15646, 0.16272, 0.1693, 0.17624, 0.18356, 0.19127, 0.19942, 0.20802, 0.21712, 0.22673, 0.23686, 0.24748, 0.2586, 0.27018, 0.28229, 0.29505, 0.30858, 0.323, 0.3384, 0.35469, 0.3717, 0.38929, 0.4073, 0.42563, 0.44431, 0.46339, 0.48294, 0.503, 0.52357, 0.54451, 0.56569, 0.58697, 0.6082, 0.62935, 0.65031, 0.67088, 0.69084, 0.71, 0.72819, 0.74546, 0.76197, 0.77784, 0.7932, 0.80811, 0.8225, 0.83631, 0.84949, 0.862, 0.87381, 0.88496, 0.89549, 0.90544, 0.91485, 0.92373, 0.93209, 0.93992, 0.94723, 0.954, 0.96026, 0.96601, 0.97126, 0.97602, 0.9803, 0.98409, 0.98742, 0.99031, 0.99281, 0.99495, 0.99671, 0.9981, 0.99911, 0.99975, 1, 0.99986, 0.9993, 0.99833, 0.9969, 0.995, 0.9926, 0.98974, 0.98644, 0.98272, 0.9786, 0.97408, 0.96917, 0.96386, 0.95813, 0.952, 0.94545, 0.9385, 0.93116, 0.92346, 0.9154, 0.90701, 0.89828, 0.8892, 0.87978, 0.87, 0.85986, 0.84939, 0.83862, 0.82758, 0.8163, 0.80479, 0.79308, 0.78119, 0.76915, 0.757, 0.74475, 0.73242, 0.72, 0.7075, 0.6949, 0.68222, 0.66947, 0.65667, 0.64384, 0.631, 0.61816, 0.60531, 0.59248, 0.57964, 0.5668, 0.55396, 0.54114, 0.52835, 0.51563, 0.503, 0.49047, 0.47803, 0.46568, 0.4534, 0.4412, 0.42908, 0.41704, 0.40503, 0.39303, 0.381, 0.36892, 0.35683, 0.34478, 0.33282, 0.321, 0.30934, 0.29785, 0.28659, 0.27562, 0.265, 0.25476, 0.24489, 0.23533, 0.22605, 0.217, 0.20816, 0.19955, 0.19116, 0.18297, 0.175, 0.16722, 0.15965, 0.15228, 0.14513, 0.1382, 0.1315, 0.12502, 0.11878, 0.11277, 0.107, 0.10148, 0.09619, 0.09112, 0.08626, 0.0816, 0.07712, 0.07283, 0.06871, 0.06477, 0.061, 0.0574, 0.05396, 0.05067, 0.04755, 0.04458, 0.04176, 0.03908, 0.03656, 0.0342, 0.032, 0.02996, 0.02808, 0.02633, 0.02471, 0.0232, 0.0218, 0.0205, 0.01928, 0.01812, 0.017, 0.0159, 0.01484, 0.01381, 0.01283, 0.01192, 0.01107, 0.01027, 0.00953, 0.00885, 0.00821, 0.00762, 0.00709, 0.00659, 0.00614, 0.00572, 0.00534, 0.005, 0.00468, 0.00438, 0.0041, 0.00384, 0.00359, 0.00335, 0.00313, 0.00293, 0.00274, 0.00256, 0.00239, 0.00224, 0.00209, 0.00195, 0.00182, 0.0017, 0.00159, 0.00148, 0.00138, 0.00129, 0.0012, 0.00112, 0.00105, 0.00098, 0.00091, 0.00085, 0.00079, 0.00074, 0.00069, 0.00064, 0.0006, 0.00056, 0.00052, 0.00048, 0.00045, 0.00042, 0.00039, 0.00036, 0.00034, 0.00031, 0.00029, 0.00027, 0.00025, 0.00023, 0.00021, 0.0002, 0.00019, 0.00017, 0.00016, 0.00015, 0.00014, 0.00013, 0.00012, 0.00011, 0.0001, 0.0001, 0.00009, 0.00008, 0.00008, 0.00007, 0.00007, 0.00006, 0.00006, 0.00006, 0.00005, 0.00005, 0.00005, 0.00004, 0.00004, 0.00004, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00002, 0.00001]
    
    #define D65 efficacy of luminous radiation
    D65 = [0.429785, 0.433171, 0.436557, 0.439943, 0.44333, 0.446716, 0.450102, 0.453488, 0.456874, 0.460261, 0.463647, 0.487502, 0.511358, 0.535214, 0.559069, 0.582925, 0.60678, 0.630636, 0.654491, 0.678347, 0.702202, 0.709613, 0.717024, 0.724435, 0.731846, 0.739257, 0.746668, 0.754079, 0.76149, 0.768901, 0.776312, 0.777967, 0.779622, 0.781277, 0.782931, 0.784586, 0.786241, 0.787896, 0.789551, 0.791206, 0.792861, 0.787137, 0.781413, 0.775689, 0.769965, 0.764242, 0.758518, 0.752794, 0.74707, 0.741346, 0.735623, 0.751062, 0.766501, 0.78194, 0.797379, 0.812818, 0.828258, 0.843697, 0.859136, 0.874575, 0.890014, 0.900326, 0.910637, 0.920949, 0.93126, 0.941572, 0.951884, 0.962195, 0.972507, 0.982818, 0.99313, 0.993817, 0.994504, 0.995191, 0.995878, 0.996565, 0.997252, 0.997939, 0.998626, 0.999313, 1, 0.997499, 0.994999, 0.992498, 0.989998, 0.987497, 0.984996, 0.982496, 0.979995, 0.977495, 0.974994, 0.9759, 0.976806, 0.977712, 0.978618, 0.979523, 0.980429, 0.981335, 0.982241, 0.983147, 0.984053, 0.978019, 0.971985, 0.965951, 0.959917, 0.953883, 0.947849, 0.941815, 0.935781, 0.929747, 0.923713, 0.924179, 0.924646, 0.925112, 0.925578, 0.926045, 0.926511, 0.926977, 0.927444, 0.92791, 0.928377, 0.927062, 0.925747, 0.924432, 0.923117, 0.921802, 0.920487, 0.919172, 0.917856, 0.916541, 0.915226, 0.912674, 0.910122, 0.90757, 0.905018, 0.902465, 0.899913, 0.897361, 0.894809, 0.892256, 0.889704, 0.892169, 0.894635, 0.8971, 0.899565, 0.90203, 0.904495, 0.906961, 0.909426, 0.911891, 0.914356, 0.91157, 0.908784, 0.905998, 0.903212, 0.900426, 0.89764, 0.894853, 0.892067, 0.889281, 0.886495, 0.886193, 0.88589, 0.885588, 0.885286, 0.884983, 0.884681, 0.884379, 0.884076, 0.883774, 0.883471, 0.880038, 0.876605, 0.873171, 0.869738, 0.866304, 0.862871, 0.859437, 0.856004, 0.85257, 0.849137, 0.846026, 0.842915, 0.839804, 0.836694, 0.833583, 0.830472, 0.827361, 0.82425, 0.82114, 0.818029, 0.817567, 0.817106, 0.816644, 0.816183, 0.815721, 0.81526, 0.814798, 0.814337, 0.813875, 0.813414, 0.807384, 0.801354, 0.795324, 0.789294, 0.783264, 0.777234, 0.771204, 0.765174, 0.759144, 0.753114, 0.754239, 0.755363, 0.756488, 0.757613, 0.758737, 0.759862, 0.760986, 0.762111, 0.763236, 0.76436, 0.764017, 0.763673, 0.76333, 0.762986, 0.762642, 0.762299, 0.761955, 0.761612, 0.761268, 0.760925, 0.759313, 0.757701, 0.756089, 0.754478, 0.752866, 0.751254, 0.749642, 0.748031, 0.746419, 0.744807, 0.741063, 0.73732, 0.733576, 0.729833, 0.726089, 0.722346, 0.718602, 0.714859, 0.711115, 0.707372, 0.707723, 0.708074, 0.708425, 0.708776, 0.709128, 0.709479, 0.70983, 0.710181, 0.710532, 0.710883, 0.707765, 0.704647, 0.701529, 0.69841, 0.695292, 0.692174, 0.689056, 0.685937, 0.682819, 0.679701, 0.679863, 0.680024, 0.680186, 0.680348, 0.680509, 0.680671, 0.680833, 0.680995, 0.681156, 0.681318, 0.683073, 0.684828, 0.686583, 0.688338, 0.690092, 0.691847, 0.693602, 0.695357, 0.697112, 0.698867, 0.695476, 0.692084, 0.688693, 0.685302, 0.68191, 0.678519, 0.675128, 0.671736, 0.668345, 0.664954, 0.65768, 0.650406, 0.643132, 0.635858, 0.628584, 0.62131, 0.614036, 0.606762, 0.599488, 0.592214, 0.593819, 0.595424, 0.597029, 0.598635, 0.60024, 0.601845, 0.60345, 0.605056, 0.606661, 0.608266, 0.610591, 0.612917, 0.615242, 0.617568, 0.619893, 0.622219, 0.624544, 0.62687, 0.629195, 0.631521, 0.620695, 0.609869, 0.599043, 0.588218, 0.577392, 0.566566, 0.55574, 0.544915, 0.534089, 0.523263, 0.530297, 0.537331, 0.544364, 0.551398, 0.558432, 0.565465, 0.572499, 0.579533, 0.586567, 0.5936, 0.598018, 0.602435, 0.606853, 0.611271, 0.615688, 0.620106, 0.624524, 0.628941, 0.633359, 0.637776, 0.628013, 0.61825, 0.608487, 0.598723, 0.58896, 0.579197, 0.569434, 0.55967, 0.549907, 0.540144, 0.525557, 0.51097, 0.496382, 0.481795, 0.467208, 0.452621, 0.438034, 0.423447, 0.40886, 0.394273, 0.411589, 0.428906, 0.446223, 0.463539, 0.480856, 0.498173, 0.515489, 0.532806, 0.550123, 0.567439, 0.564532, 0.561624, 0.558717, 0.555809, 0.552902, 0.549994, 0.547087, 0.544179, 0.541272, 0.538364]
    
    #define the wavelength step size for the calculations
    dl = 1
    
    #pick the selected action spectrum
    if alpha == 1:
        alpha_opic = S
    elif alpha == 2:
        alpha_opic = M
    elif alpha == 3:
        alpha_opic = L
    elif alpha == 4:
        alpha_opic = rhod
    elif alpha == 5:
        alpha_opic = mel
    else:
        ghenv.Component.AddRuntimeMessage(RML.Error, "alpha should be an integer between 1 and 5 (1: S-cone-opic, 2: M-cone-opic, 3: L-cone-opic, 4: rhodopic, 5: melanopic)") 
    print alpha
    
    #define the bins between 380 - 780nm for 9 and 3 channels (bin and channel are interchangeable terms)
    bin9 = [380,422],[422,460],[460,498],[498,524],[524,550],[550,586],[586,650],[650,714],[714,780] #9 channels: b1,b2,b3,g1,g2,g3,r1,r2,r3 
    bin3 = [586,780],[498,586],[380,498]  #3 channels: r,g,b 
    
    if len(channel_output) == 3:
        binType = bin3
    elif len(channel_output) == 9:
        binType = bin9
    else:
        ghenv.Component.AddRuntimeMessage(RML.Error, "channel_output should contain either 3 or 9 values")
    
    #calculate length of each bin
    bin_length = []
    for i in range(len(binType)):
        bin_length.append(binType[i][1] - binType[i][0])
    
    
    
    #derive the irradiance over bin
    I = []
    for i in channel_output:
        I.append((179/683) * (1/107) * i) # 3 or 9 values
    
    #derive pectral irradinace every 1nm
    Irrad = []
    for i in range(len(binType)):
        for j in range(bin_length[i]):
            Irrad.append(I[i])
    Irrad.append(I[-1]) # add the 780 nm
    
    
    
    #derive alpha-opic irradiance = integral_380->780(spectral irradiance * aplha-opic action spectrum * dl)
    list = []
    for i in range(len(Irrad)):
        list.append(Irrad[i] * alpha_opic[i] * dl)
    alpha_opic_irrad =sum(list)
    
    
    
    #derive alpha-opic Eficacy of Luminous Radiation (ELR) = a-opic irradiance / illuminance
    list = []
    for i in range(len(Irrad)):
        list.append(Irrad[i] * V[i] * dl)
    illum = 683 * sum(list) #illuminance 
    if illum == 0:
        alpha_opic_ELR = 0
    else:
        alpha_opic_ELR = (alpha_opic_irrad / illum) * 1000 # mW/lm
    
    
    
    #derive alpha-opic EDI = alpha-opic irradiance / alpha-opic ELR for D65
    list = []
    for i in range(len(D65)):
        list.append(D65[i] * alpha_opic[i] * dl)
    alpha_opic_irradD65 =sum(list) #D65 aplha opic irradiance
    list = []
    for i in range(len(D65)):
        list.append(D65[i] * V[i] * dl)
    illumD65 = 683 * sum(list) #D65 illuminance
    alphaELR_D65 = (alpha_opic_irradD65 / illumD65) * 1000 # D65 ELR, mW/lm (this is a constant for each of the action spectra)
    alpha_opic_EDI = (alpha_opic_irrad * 1000)/ alphaELR_D65
    
    
    
    #print out the values
    alpha_opic_irrad = round(alpha_opic_irrad,2)
    alpha_opic_ELR = round(alpha_opic_ELR,2)
    alpha_opic_EDI = round(alpha_opic_EDI,2)
    Irradiance = Irrad
